{%- extends 'messages/base/messages_base.html.twig' -%}

{%- block btn_top_add -%}
    {%- if pp_role('admin')
        and filter_uid
        and uid
        and not su_is_owner(uid) -%}
        {%- include 'include/btn_top/add.html.twig' with {
            'btn_route': 'messages_add',
            'btn_route_params': {'uid': uid},
            'btn_title': 'messages_add.btn_add_for_user',
            'btn_title_trans_params': {
                'user': account(uid, schema)
            }
        } -%}
    {%- elseif pp_role('admin') or pp_role('user') -%}
        {%- include 'include/btn_top/add.html.twig' with {
            'btn_route': 'messages_add',
            'btn_title': 'messages_add.title'
        } -%}
    {%- endif -%}
{%- endblock btn_top_add -%}

{%- set messages_view_btns = {
    ('messages_list'~ (is_self ? '_self' : '')): {'fa': 'align-justify', 'title': 'view.list'},
    ('messages_extended' ~ (is_self ? '_self' : '')): {'fa': 'th-list', 'title': 'view.extended'}
} -%}

{%- block btn_view -%}
    {%- include 'include/view_btn_group.html.twig' with {'btns': messages_view_btns} -%}
{%- endblock btn_view -%}

{%- block heading_title -%}
    {{- 'messages.title'|trans({
        'self': filter_uid ? (is_self ? 'self' : 'some_user') : 'all_users',
        'with_without_category': filter_cid ? (cid == 'null' ? 'without' : 'with') : 'all_categories',
        'user': account(uid, schema)|link('users_show', {'id': uid}),
        'category_name': categories[cid] ?? ''
    })|raw -}}
{%- endblock heading_title -%}

{%- block heading_append -%}
    {%- include 'include/heading_filter.html.twig' -%}
{%- endblock heading_append -%}

{%- block filter_form -%}
    {{- filter_form_raw|raw -}}
{%- endblock filter_form -%}

{%- block pagination -%}
    {%- include 'include/pagination.html.twig' -%}
{%- endblock pagination -%}

{%- block content -%}{%- endblock -%}

{%- block data_list -%}
    {%- if row_count -%}
        {{- data_list_raw|raw -}}
    {%- else -%}
        {%- include 'include/no_results.html.twig' -%}
    {%- endif -%}
{%- endblock data_list -%}

{%- block bulk_actions -%}
    {{- bulk_actions_raw|raw -}}
{%- endblock bulk_actions -%}
